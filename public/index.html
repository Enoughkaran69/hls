<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HLS Stream Info</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #output { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>HLS Stream Info</h1>
    <form id="streamForm">
        <label for="hlsUrl">HLS URL:</label>
        <input type="url" id="hlsUrl" placeholder="Enter HLS URL" required />
        <button type="submit">Get Stream Info</button>
    </form>

    <div id="output"></div>

    <script>
        const form = document.getElementById("streamForm");
        const output = document.getElementById("output");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const hlsUrl = document.getElementById("hlsUrl").value;

            // Fetch stream info
            try {
                const response = await fetch("/getStreams", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ hlsUrl })
                });

                if (!response.ok) throw new Error("Failed to fetch stream info");
                const { streams } = await response.json();
                displayStreams(streams);
            } catch (error) {
                output.innerHTML = `<p style="color: red;">${error.message}</p>`;
            }
        });

        function displayStreams(streams) {
            output.innerHTML = `<h2>Stream Information</h2>`;
            if (streams.length === 0) {
                output.innerHTML += `<p>No streams found.</p>`;
                return;
            }

            const list = document.createElement("ul");
            streams.forEach((stream, index) => {
                const item = document.createElement("li");
                item.textContent = `${index + 1}. Type: ${stream.type}, Codec: ${stream.codec}, ${
                    stream.type === "video" ? `Resolution: ${stream.resolution}` : `Sample Rate: ${stream.sampleRate} Hz`
                }`;
                list.appendChild(item);
            });
            output.appendChild(list);
        }
    </script>
</body>
</html>
